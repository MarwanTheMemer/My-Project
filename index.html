<!DOCTYPE html>
<html>
<head>
  <title>معركة الفيروسات!</title>
  <style>
    /* Existing styles omitted for brevity */
    .laser-border {
      position: relative;
      border: 2px solid transparent;
      box-shadow: 0 0 15px 5px green;
      transition: all 0.3s ease;
    }
    .laser-border:hover {
      transform: scale(1.05);
    }
  </style>
</head>
<body>
  <div id="gameContainer">
    <div class="score">النقاط: <span id="scoreValue">0</span></div>
    <div class="coins">العملات: <span id="coinsValue">0</span></div>
    <div class="health">الصحة: <span id="healthValue">100</span></div>
    <button class="shop-button laser-border" id="shopButton">المتجر</button>
    <div class="shop-modal laser-border" id="shopModal">
      <h2>المتجر</h2>
      <div class="shop-item laser-border" data-cost="100" id="buyHelper">
        شراء مساعد (100 عملة) - يساعد في إطلاق النار على الفيروسات
      </div>
      <button onclick="closeShop()" class="laser-border">إغلاق</button>
    </div>
    <div class="game-over" id="gameOver">
      انتهت اللعبة
      <button class="retry-button laser-border" id="retryButton">إعادة المحاولة</button>
    </div>
    <div class="start-screen" id="startScreen">
      <h1>معركة الفيروسات!</h1>
      <p>تحرك بالماوس واضغط للتصويب!</p>
      <button class="start-button laser-border" id="startButton">ابدأ اللعبة</button>
    </div>
    <div class="difficulty-screen laser-border" id="difficultyScreen">
      <h1>اختر مستوى الصعوبة</h1>
      <button class="laser-border" onclick="setDifficulty('easy')">سهل</button>
      <button class="laser-border" onclick="setDifficulty('medium')">متوسط</button>
      <button class="laser-border" onclick="setDifficulty('hard')">صعب</button>
    </div>
  </div>

  <script>
    let difficulty = 'medium';
    let virusHealth = 1;

    function setDifficulty(level) {
      difficulty = level;
      switch (level) {
        case 'easy':
          virusHealth = 1;
          break;
        case 'medium':
          virusHealth = 2;
          break;
        case 'hard':
          virusHealth = 3;
          break;
      }
      document.getElementById('difficultyScreen').style.display = 'none';
      startScreen.style.display = 'block';
    }

    function createVirus() {
      const virus = document.createElement('div');
      virus.className = 'virus';
      virus.dataset.health = virusHealth;
      virus.style.left = Math.random() * (gameContainer.offsetWidth - 50) + 'px';
      virus.style.top = '0px';
      gameContainer.appendChild(virus);
      viruses.push(virus);
    }

    function updateGame() {
      if (!gameActive) return;

      const playerRect = player.getBoundingClientRect();

      viruses.forEach((virus, index) => {
        const virusRect = virus.getBoundingClientRect();
        let virusHealth = parseInt(virus.dataset.health);
        const top = parseFloat(virus.style.top) || 0;

        if (score >= 200) {
          virus.dataset.health = virusHealth;
        }

        if (checkCollision(playerRect, virusRect)) {
          health -= 1;
          healthElement.textContent = health;
          if (health <= 0) gameOver();
        }

        bullets.forEach((bullet, bulletIndex) => {
          const bulletRect = bullet.getBoundingClientRect();
          if (checkCollision(bulletRect, virusRect)) {
            virusHealth -= 1;
            if (virusHealth <= 0) {
              gameContainer.removeChild(virus);
              viruses.splice(index, 1);
              score += 10;
              coins += 10;
              scoreElement.textContent = score;
              coinsElement.textContent = coins;
            } else {
              virus.dataset.health = virusHealth;
            }
            gameContainer.removeChild(bullet);
            bullets.splice(bulletIndex, 1);
          }
        });
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('difficultyScreen').style.display = 'block';
    });

    startButton.addEventListener('click', startGame);
    retryButton.addEventListener('click', startGame);
    shopButton.addEventListener('click', openShop);
    buyHelperButton.addEventListener('click', buyHelper);
  </script>
</body>
</html>
